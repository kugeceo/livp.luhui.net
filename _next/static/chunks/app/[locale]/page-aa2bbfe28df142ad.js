(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[61],{2490:function(e,s,a){Promise.resolve().then(a.bind(a,6418)),Promise.resolve().then(a.bind(a,9721))},6418:function(e,s,a){"use strict";a.r(s);var t=a(3827),r=a(4232),n=a(4090),i=a(1101),o=a.n(i),l=a(3555),c=a.n(l),m=a(7387);let f=(0,r.default)(()=>Promise.resolve(e=>{let{children:s}=e;return(0,t.jsx)(t.Fragment,{children:s})}),{ssr:!1});s.default=()=>{let{t:e}=(0,m.useI18n)(),[s,a]=(0,n.useState)("jpg"),[r,i]=(0,n.useState)([]),l=async e=>{try{let a=new(o()),t=await a.loadAsync(e),r=Object.values(t.files).find(e=>{let s=e.name.toLowerCase();return s.endsWith(".jpg")||s.endsWith(".heic")||s.endsWith(".mov")});if(!r)throw Error("未在LIVP包中找到媒体文件");let n=await r.async("blob"),i=r.name.toLowerCase();if("jpg"===s&&i.endsWith(".heic"))return await c()({blob:n,toType:"image/jpeg",quality:.9});return n}catch(e){throw console.error("转换失败:",e),e}},d=async e=>{for(let s of(i([]),Array.from(e))){let e=Math.random().toString(36).substr(2,9);if(!s.name.toLowerCase().endsWith(".livp")){i(a=>[...a,{id:e,status:"error",fileName:s.name,message:"不是LIVP文件"}]);continue}i(a=>[...a,{id:e,status:"processing",fileName:s.name}]);try{let a=await l(s),t=URL.createObjectURL(a);i(s=>s.map(s=>s.id===e?{...s,status:"success",url:t}:s))}catch(s){i(a=>a.map(a=>a.id===e?{...a,status:"error",message:s.message}:a))}}},h=(0,n.useCallback)(e=>{e.preventDefault(),d(e.dataTransfer.files)},[]);return(0,t.jsx)(f,{children:(0,t.jsxs)("div",{className:"container",children:[(0,t.jsxs)("h1",{className:"title",children:[(0,t.jsx)("i",{className:"fas fa-image"}),String(e("home.title")),(0,t.jsx)("i",{className:"fas fa-exchange-alt"})]}),(0,t.jsxs)("div",{className:"format-selector",children:[(0,t.jsxs)("button",{className:"format-button ".concat("jpg"===s?"active":""),onClick:()=>a("jpg"),children:[(0,t.jsx)("i",{className:"fas fa-image"}),String(e("home.buttons.toJpg"))]}),(0,t.jsxs)("button",{className:"format-button ".concat("heic"===s?"active":""),onClick:()=>a("heic"),children:[(0,t.jsx)("i",{className:"fas fa-file-image"}),String(e("home.buttons.toHeic"))]}),(0,t.jsxs)("button",{className:"format-button ".concat("mov"===s?"active":""),onClick:()=>a("mov"),children:[(0,t.jsx)("i",{className:"fas fa-film"}),String(e("home.buttons.toMov"))]})]}),(0,t.jsxs)("div",{className:"drop-zone",onDragOver:e=>e.preventDefault(),onDrop:h,onClick:()=>{var e;return null===(e=document.getElementById("fileInput"))||void 0===e?void 0:e.click()},children:[(0,t.jsx)("i",{className:"fas fa-cloud-upload-alt animated-icon"}),(0,t.jsx)("p",{children:String(e("home.dropzone.text"))}),(0,t.jsx)("p",{children:String(e("home.dropzone.or"))}),(0,t.jsx)("input",{type:"file",id:"fileInput",accept:".livp",multiple:!0,style:{display:"none"},onChange:e=>e.target.files&&d(e.target.files)})]}),(0,t.jsxs)("p",{className:"support-text",children:[(0,t.jsx)("i",{className:"fas fa-info-circle"}),String(e("home.support.text"))]}),(0,t.jsx)("div",{className:"progress-container",children:r.map(a=>(0,t.jsxs)("div",{className:"progress-item ".concat("error"===a.status?"error":""),children:["processing"===a.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"fas fa-spinner fa-spin"}),(0,t.jsxs)("span",{className:"progress-text",children:[String(e("home.progress.processing"))," ",a.fileName,"..."]})]}),"success"===a.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"fas fa-check-circle",style:{color:"#4caf50"}}),(0,t.jsxs)("span",{className:"progress-text",children:[a.fileName," ",String(e("home.progress.completed"))]}),(0,t.jsx)("a",{href:a.url,download:a.fileName.replace(".livp","jpg"===s?".jpg":"heic"===s?".heic":".mov"),className:"download-link",children:String(e("home.buttons.download"))})]}),"error"===a.status&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("i",{className:"fas fa-times-circle",style:{color:"#f44336"}}),(0,t.jsxs)("span",{className:"progress-text",children:[String(e("home.progress.error"))," ",a.fileName,": ",a.message]})]})]},a.id))})]})})}}},function(e){e.O(0,[565,156,923,387,971,69,744],function(){return e(e.s=2490)}),_N_E=e.O()}]);